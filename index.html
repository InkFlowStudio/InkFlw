<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>InkFlow Studio | Pixel Art Drawing Tool</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* Reset and base styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #1e1e2e;
  color: #e0e0e0;
  overflow-x: hidden;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Navigation */
.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  background-color: #252538;
  border-bottom: 1px solid #3a3a5a;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.2rem;
}

.logo i {
  color: #8a2be2;
  font-size: 1.5rem;
}

.nav-links {
  display: flex;
  gap: 20px;
}

.nav-links a {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #a0a0c0;
  text-decoration: none;
  padding: 8px 15px;
  border-radius: 6px;
  transition: all 0.3s ease;
}

.nav-links a.active, .nav-links a:hover {
  background-color: #3a3a5a;
  color: #ffffff;
}

/* Main Content */
.main-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 20px;
  overflow: hidden;
}

.content-section {
  display: none;
  height: 100%;
}

.content-section.active {
  display: flex;
  flex-direction: column;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #3a3a5a;
}

/* Studio Layout */
.studio-content {
  display: flex;
  flex: 1;
  gap: 20px;
  height: calc(100vh - 150px);
}

.reference-panel {
  width: 250px;
  background-color: #252538;
  border-radius: 10px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.reference-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.reference-image-container {
  flex: 1;
  border: 2px dashed #3a3a5a;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 15px;
  overflow: hidden;
  position: relative;
  min-height: 200px;
}

.reference-placeholder {
  text-align: center;
  color: #6a6a8a;
  padding: 20px;
}

.reference-image {
  max-width: 100%;
  max-height: 100%;
  display: none;
}

.reference-controls {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.slider-container {
  display: flex;
  align-items: center;
  gap: 10px;
}

.slider-container input {
  flex: 1;
}

.slider-value {
  min-width: 40px;
  text-align: right;
}

.canvas-section {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.canvas-container {
  flex: 1;
  background-color: #252538;
  border-radius: 10px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

#drawing-canvas {
  display: block;
  background-color: #000;
  cursor: crosshair;
}

.zoom-controls {
  position: absolute;
  top: 15px;
  right: 15px;
  background-color: rgba(37, 37, 56, 0.8);
  border-radius: 8px;
  padding: 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.zoom-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #3a3a5a;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.zoom-btn:hover {
  background-color: #4a4a6a;
}

.zoom-display {
  font-size: 0.8rem;
  font-weight: bold;
}

.canvas-controls {
  position: absolute;
  bottom: 15px;
  right: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
}

.canvas-nav-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #3a3a5a;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.canvas-nav-btn:hover {
  background-color: #4a4a6a;
}

#alex-box {
  background-color: #252538;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

#alex-text {
  font-style: italic;
  color: #a0a0c0;
}

.tools-section {
  width: 300px;
  overflow-y: auto;
  background-color: #252538;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.tools-container {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.tool-group {
  border-bottom: 1px solid #3a3a5a;
  padding-bottom: 15px;
}

.tool-group:last-child {
  border-bottom: none;
}

.tool-group h3 {
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
}

/* Color picker */
.color-picker {
  margin-bottom: 15px;
}

#color-picker {
  width: 100%;
  height: 40px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.preset-colors {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-top: 10px;
}

.preset-color {
  aspect-ratio: 1;
  border-radius: 6px;
  cursor: pointer;
  border: 2px solid transparent;
  transition: transform 0.2s, border-color 0.2s;
}

.preset-color.active {
  border-color: #ffffff;
  transform: scale(1.1);
}

.preset-color:hover {
  transform: scale(1.05);
}

/* Controls */
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.hotkey-hint {
  font-size: 0.8rem;
  color: #6a6a8a;
  margin-top: 10px;
  text-align: center;
}

/* Brushes */
.brush-types {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.brush-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px 5px;
  background-color: #2d2d44;
  border: none;
  border-radius: 8px;
  color: #e0e0e0;
  cursor: pointer;
  transition: all 0.2s;
}

.brush-btn.active, .brush-btn:hover {
  background-color: #3a3a5a;
  transform: translateY(-2px);
}

.brush-icon {
  font-size: 1.2rem;
  margin-bottom: 5px;
}

.brush-name {
  font-size: 0.8rem;
}

/* Blending modes */
.blend-modes {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.blend-btn {
  padding: 8px 5px;
  background-color: #2d2d44;
  border: none;
  border-radius: 6px;
  color: #e0e0e0;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.8rem;
}

.blend-btn.active, .blend-btn:hover {
  background-color: #3a3a5a;
}

/* Layers */
.layer-controls {
  max-height: 200px;
  overflow-y: auto;
  margin-bottom: 10px;
}

.layer-row {
  display: flex;
  align-items: center;
  padding: 8px;
  background-color: #2d2d44;
  border-radius: 6px;
  margin-bottom: 5px;
  transition: background-color 0.2s;
}

.layer-row.active {
  background-color: #3a3a5a;
}

.layer-btn {
  background: none;
  border: none;
  color: #e0e0e0;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.layer-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

.layer-name {
  flex: 1;
  margin: 0 10px;
  font-size: 0.9rem;
}

.layer-visibility {
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.layer-visibility:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

.layer-actions {
  display: flex;
  gap: 5px;
}

.layer-move-btn {
  background: none;
  border: none;
  color: #e0e0e0;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  transition: background-color 0.2s;
  font-size: 0.8rem;
}

.layer-move-btn:hover:not(:disabled) {
  background-color: rgba(255, 255, 255, 0.1);
}

.layer-move-btn:disabled {
  color: #6a6a8a;
  cursor: not-allowed;
}

/* Background selector */
.background-selector {
  display: flex;
  gap: 8px;
}

.bg-option {
  flex: 1;
  padding: 8px 5px;
  text-align: center;
  background-color: #2d2d44;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.8rem;
}

.bg-option.active, .bg-option:hover {
  background-color: #3a3a5a;
}

.bg-option.black {
  background-color: #000;
  color: #fff;
}

.bg-option.white {
  background-color: #fff;
  color: #000;
}

.bg-option.transparent {
  background: linear-gradient(45deg, #3a3a5a 25%, transparent 25%), 
              linear-gradient(-45deg, #3a3a5a 25%, transparent 25%), 
              linear-gradient(45deg, transparent 75%, #3a3a5a 75%), 
              linear-gradient(-45deg, transparent 75%, #3a3a5a 75%);
  background-size: 10px 10px;
  background-position: 0 0, 0 5px, 5px -5px, -5px 0px;
  color: #e0e0e0;
}

/* Symmetry */
.symmetry-controls {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.symmetry-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px 5px;
  background-color: #2d2d44;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}

.symmetry-option.active, .symmetry-option:hover {
  background-color: #3a3a5a;
  transform: translateY(-2px);
}

.symmetry-option i {
  font-size: 1.2rem;
  margin-bottom: 5px;
}

.symmetry-option span {
  font-size: 0.8rem;
}

/* Buttons */
.btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 15px;
  background-color: #3a3a5a;
  border: none;
  border-radius: 6px;
  color: #e0e0e0;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.btn:hover {
  background-color: #4a4a6a;
  transform: translateY(-2px);
}

.btn-upload {
  background-color: #8a2be2;
}

.btn-upload:hover {
  background-color: #9b3cf3;
}

.btn-save {
  background-color: #06d6a0;
  color: #000;
}

.btn-save:hover {
  background-color: #17e7b1;
}

.btn-clear {
  background-color: #ff6b6b;
  color: #000;
}

.btn-clear:hover {
  background-color: #ff7c7c;
}

.btn-undo {
  background-color: #ffd166;
  color: #000;
}

.btn-undo:hover {
  background-color: #ffe277;
}

.btn-download {
  background-color: #4fc3f7;
  color: #000;
}

.btn-download:hover {
  background-color: #60d4ff;
}

.btn-layer {
  background-color: #8a2be2;
  width: 100%;
  justify-content: center;
  margin-bottom: 5px;
}

.projects-btn {
  background-color: #06d6a0;
  color: #000;
  width: 100%;
  justify-content: center;
  margin-top: 10px;
}

.projects-btn:hover {
  background-color: #17e7b1;
}

/* Footer */
.footer {
  text-align: center;
  padding: 15px;
  background-color: #252538;
  border-top: 1px solid #3a3a5a;
  color: #a0a0c0;
  font-size: 0.9rem;
}

/* Modals */
.download-modal, .size-modal, .text-tool-container {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}

.download-panel, .size-panel {
  background-color: #252538;
  border-radius: 10px;
  padding: 20px;
  width: 400px;
  max-width: 90%;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.download-header, .size-header {
  margin-bottom: 20px;
  text-align: center;
}

.download-header h2, .size-header h2 {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-bottom: 10px;
}

.filename-input {
  width: 100%;
  padding: 12px;
  background-color: #2d2d44;
  border: 1px solid #3a3a5a;
  border-radius: 6px;
  color: #e0e0e0;
  margin-bottom: 20px;
  font-size: 1rem;
}

.download-actions, .size-actions {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

.download-confirm, .size-confirm {
  background-color: #4fc3f7;
  color: #000;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.download-confirm:hover, .size-confirm:hover {
  background-color: #60d4ff;
}

.download-cancel, .size-cancel {
  background-color: #6a6a8a;
  color: #e0e0e0;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.download-cancel:hover, .size-cancel:hover {
  background-color: #7a7a9a;
}

.size-inputs {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
}

.size-input {
  flex: 1;
}

.size-input label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
}

.size-input input {
  width: 100%;
  padding: 10px;
  background-color: #2d2d44;
  border: 1px solid #3a3a5a;
  border-radius: 6px;
  color: #e0e0e0;
  font-size: 1rem;
}

/* Text Tool */
.text-tool-container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 350px;
  background-color: #252538;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  z-index: 1001;
}

.text-tool-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.text-input {
  width: 100%;
  padding: 12px;
  background-color: #2d2d44;
  border: 1px solid #3a3a5a;
  border-radius: 6px;
  color: #e0e0e0;
  margin-bottom: 15px;
  font-size: 1rem;
}

.text-preview {
  padding: 15px;
  background-color: #2d2d44;
  border-radius: 6px;
  margin-bottom: 15px;
  text-align: center;
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.font-select {
  width: 100%;
  padding: 10px;
  background-color: #2d2d44;
  border: 1px solid #3a3a5a;
  border-radius: 6px;
  color: #e0e0e0;
  margin-bottom: 15px;
  font-size: 0.9rem;
}

.text-tool-settings {
  display: flex;
  gap: 8px;
  margin-bottom: 15px;
}

.text-style-btn {
  flex: 1;
  padding: 8px;
  background-color: #2d2d44;
  border: none;
  border-radius: 6px;
  color: #e0e0e0;
  cursor: pointer;
  transition: background-color 0.3s;
}

.text-style-btn.active, .text-style-btn:hover {
  background-color: #3a3a5a;
}

.text-tool-actions {
  display: flex;
  gap: 10px;
}

.text-confirm {
  flex: 1;
  background-color: #4fc3f7;
  color: #000;
  border: none;
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.text-confirm:hover {
  background-color: #60d4ff;
}

.text-cancel {
  flex: 1;
  background-color: #6a6a8a;
  color: #e0e0e0;
  border: none;
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.text-cancel:hover {
  background-color: #7a7a9a;
}

/* Responsive adjustments */
@media (max-width: 1200px) {
  .studio-content {
    flex-direction: column;
    height: auto;
  }
  
  .reference-panel, .tools-section {
    width: 100%;
  }
  
  .canvas-container {
    min-height: 500px;
  }
}

@media (max-width: 768px) {
  .navbar {
    flex-direction: column;
    gap: 15px;
  }
  
  .nav-links {
    width: 100%;
    justify-content: center;
  }
  
  .main-container {
    padding: 10px;
  }
  
  .section-header {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }
  
  .brush-types, .blend-modes {
    grid-template-columns: repeat(3, 1fr);
  }
}
</style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
<div class="logo">
<i class="fas fa-palette"></i>
<h1>InkFlow Studio</h1>
</div>
<div class="nav-links">
<a href="#" class="active" data-section="studio"><i class="fas fa-draw-polygon"></i> Studio</a>
</div>
</nav>

<!-- Main Content -->
<div class="main-container">
<!-- Studio Section -->
<div class="content-section active" id="studio-section">
<div class="section-header">
<h2><i class="fas fa-draw-polygon"></i> Pixel Art Studio</h2>
</div>
<div class="studio-content">
<div class="reference-panel">
<div class="reference-header">
<h3><i class="fas fa-image"></i> Reference Image</h3>
<button class="btn btn-upload" id="upload-ref-btn"><i class="fas fa-upload"></i> Upload</button>
</div>
<div class="reference-image-container">
<div class="reference-placeholder">
<i class="fas fa-cloud-upload-alt" style="font-size: 3rem; margin-bottom: 15px;"></i>
<p>Upload a reference image to help with your artwork</p>
</div>
<img src="" alt="Reference Image" class="reference-image" id="reference-image">
</div>
<div class="reference-controls">
<div class="slider-container">
<i class="fas fa-adjust"></i>
<input type="range" id="ref-opacity" min="10" max="100" value="70">
<span class="slider-value" id="ref-opacity-value">70%</span>
</div>
<button class="btn btn-clear" id="clear-ref-btn"><i class="fas fa-times"></i> Clear Reference</button>
</div>
</div>

<div class="canvas-section">
<div class="canvas-container">
<canvas id="drawing-canvas"></canvas>
<div class="zoom-controls">
<div class="zoom-btn" id="zoom-in"><i class="fas fa-plus"></i></div>
<div class="zoom-display" id="zoom-display">100%</div>
<div class="zoom-btn" id="zoom-out"><i class="fas fa-minus"></i></div>
<div class="zoom-btn" id="reset-view"><i class="fas fa-sync"></i></div>
</div>
<!-- Canvas Navigation Controls -->
<div class="canvas-controls">
<div class="canvas-nav-btn" id="pan-up"><i class="fas fa-arrow-up"></i></div>
<div style="display: flex; gap: 10px;">
<div class="canvas-nav-btn" id="pan-left"><i class="fas fa-arrow-left"></i></div>
<div class="canvas-nav-btn" id="pan-right"><i class="fas fa-arrow-right"></i></div>
</div>
<div class="canvas-nav-btn" id="pan-down"><i class="fas fa-arrow-down"></i></div>
</div>
</div>
<div id="alex-box">
<p id="alex-text"><i class="fas fa-quote-left"></i> Use layers to organize your artwork! Hide layers by clicking the eye icon, rename by double-clicking names, and reorder layers with the arrow buttons. <i class="fas fa-quote-right"></i></p>
</div>
</div>

<div class="tools-section">
<div class="tools-container">
<div class="tool-group">
<h3><i class="fas fa-fill-drip"></i> Color</h3>
<div class="color-picker">
<input type="color" id="color-picker" value="#ff6b6b">
</div>
<div class="slider-container">
<i class="fas fa-adjust"></i>
<input type="range" id="brush-opacity" min="1" max="100" value="100">
<span class="slider-value" id="opacity-value">100%</span>
</div>
<div class="preset-colors">
<div class="preset-color active" style="background-color: #ff6b6b;" data-color="#ff6b6b"></div>
<div class="preset-color" style="background-color: #4fc3f7;" data-color="#4fc3f7"></div>
<div class="preset-color" style="background-color: #8a2be2;" data-color="#8a2be2"></div>
<div class="preset-color" style="background-color: #ffd166;" data-color="#ffd166"></div>
<div class="preset-color" style="background-color: #06d6a0;" data-color="#06d6a0"></div>
<div class="preset-color" style="background-color: #ff9e6d;" data-color="#ff9e6d"></div>
</div>
</div>

<div class="tool-group">
<h3><i class="fas fa-sliders-h"></i> Controls</h3>
<div class="slider-container">
<i class="fas fa-ruler-combined"></i>
<input type="range" id="brush-size" min="1" max="40" value="10">
<span class="slider-value" id="brush-size-value">10px</span>
</div>
<div class="controls">
<button class="btn btn-clear" id="clear-btn"><i class="fas fa-broom"></i> Clear</button>
<button class="btn btn-undo" id="undo-btn"><i class="fas fa-undo-alt"></i> Undo</button>
<button class="btn btn-download" id="download-btn"><i class="fas fa-file-download"></i> Download</button>
<button class="btn" id="size-btn"><i class="fas fa-ruler"></i> Size</button>
</div>
<div class="hotkey-hint">Undo: Ctrl+Z | Clear: Ctrl+Del</div>
</div>

<div class="tool-group">
<h3><i class="fas fa-paint-brush"></i> Brushes</h3>
<div class="brush-types">
<button class="brush-btn active" id="brush-normal" data-type="normal">
<div class="brush-icon"><i class="fas fa-paint-brush"></i></div>
<div class="brush-name">Normal</div>
</button>
<button class="brush-btn" id="brush-pixel" data-type="pixel">
<div class="brush-icon"><i class="fas fa-th-large"></i></div>
<div class="brush-name">Pixel</div>
</button>
<button class="brush-btn" id="brush-rainbow" data-type="rainbow">
<div class="brush-icon"><i class="fas fa-rainbow"></i></div>
<div class="brush-name">Rainbow</div>
</button>
<button class="brush-btn" id="brush-eraser" data-type="eraser">
<div class="brush-icon"><i class="fas fa-eraser"></i></div>
<div class="brush-name">Erase</div>
</button>
</div>
</div>

<div class="tool-group">
<h3><i class="fas fa-blender"></i> Blending</h3>
<div class="blend-modes">
<button class="blend-btn active" data-mode="source-over">Normal</button>
<button class="blend-btn" data-mode="multiply">Multiply</button>
<button class="blend-btn" data-mode="screen">Screen</button>
<button class="blend-btn" data-mode="overlay">Overlay</button>
</div>
</div>

<div class="tool-group">
<h3><i class="fas fa-layer-group"></i> Layers</h3>
<div class="layer-controls" id="layer-controls">
<div class="layer-row" data-index="0">
<button class="layer-btn lock-btn" title="Lock/Unlock"><i class="fas fa-lock-open"></i></button>
<span class="layer-name">Background</span>
<span class="layer-visibility" title="Toggle Visibility"><i class="fas fa-eye"></i></span>
<div class="layer-actions">
<button class="layer-move-btn move-up-btn" title="Move Up" disabled><i class="fas fa-arrow-up"></i></button>
<button class="layer-move-btn move-down-btn" title="Move Down"><i class="fas fa-arrow-down"></i></button>
</div>
</div>
<div class="layer-row active" data-index="1">
<button class="layer-btn lock-btn" title="Lock/Unlock"><i class="fas fa-lock-open"></i></button>
<span class="layer-name">Layer 1</span>
<span class="layer-visibility" title="Toggle Visibility"><i class="fas fa-eye"></i></span>
<div class="layer-actions">
<button class="layer-move-btn move-up-btn" title="Move Up"><i class="fas fa-arrow-up"></i></button>
<button class="layer-move-btn move-down-btn" title="Move Down"><i class="fas fa-arrow-down"></i></button>
</div>
</div>
<div class="controls">
<button class="btn btn-layer" id="add-layer"><i class="fas fa-plus"></i> Add Layer</button>
<button class="btn btn-layer" id="remove-layer"><i class="fas fa-minus"></i> Remove Layer</button>
<button class="btn btn-layer" id="merge-layers"><i class="fas fa-object-group"></i> Merge</button>
</div>
</div>
</div>

<!-- Background Selector -->
<div class="tool-group">
<h3><i class="fas fa-fill"></i> Canvas Background</h3>
<div class="background-selector">
<div class="bg-option black active" data-bg="black">Black</div>
<div class="bg-option white" data-bg="white">White</div>
<div class="bg-option transparent" data-bg="transparent">Transparent</div>
</div>
</div>

<div class="tool-group">
<h3><i class="fas fa-snowflake"></i> Symmetry</h3>
<div class="symmetry-controls">
<div class="symmetry-option active" data-symmetry="none">
<i class="fas fa-ban"></i>
<span>None</span>
</div>
<div class="symmetry-option" data-symmetry="vertical">
<i class="fas fa-grip-lines-vertical"></i>
<span>Vertical</span>
</div>
<div class="symmetry-option" data-symmetry="horizontal">
<i class="fas fa-grip-lines"></i>
<span>Horizontal</span>
</div>
<div class="symmetry-option" data-symmetry="radial">
<i class="fas fa-circle"></i>
<span>Radial</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Footer -->
<footer class="footer">
<p>InkFlow Studio &copy; 2025 | :3</p>
</footer>

<!-- Download Modal -->
<div class="download-modal" id="download-modal">
<div class="download-panel">
<div class="download-header">
<h2><i class="fas fa-file-download"></i> Download Artwork</h2>
<p>Enter a filename for your artwork</p>
</div>
<input type="text" id="filename-input" class="filename-input" placeholder="Enter filename" value="inkflow-art">
<div class="download-actions">
<button class="download-confirm" id="confirm-download"><i class="fas fa-download"></i> Download</button>
<button class="download-cancel" id="cancel-download"><i class="fas fa-times"></i> Cancel</button>
</div>
</div>
</div>

<!-- Canvas Size Modal -->
<div class="size-modal" id="size-modal">
<div class="size-panel">
<div class="size-header">
<h2><i class="fas fa-ruler"></i> Set Canvas Size</h2>
</div>
<div class="size-inputs">
<div class="size-input">
<label for="canvas-width">Width (px)</label>
<input type="number" id="canvas-width" min="100" max="5000" value="800">
</div>
<div class="size-input">
<label for="canvas-height">Height (px)</label>
<input type="number" id="canvas-height" min="100" max="5000" value="600">
</div>
</div>
<div class="size-actions">
<button class="size-cancel" id="size-cancel">Cancel</button>
<button class="size-confirm" id="size-confirm">Apply</button>
</div>
</div>
</div>

<script>
// Canvas setup
const canvas = document.getElementById('drawing-canvas');
const ctx = canvas.getContext('2d');
let isDrawing = false;
let lastX = 0;
let lastY = 0;
let currentColor = '#ff6b6b';
let brushSize = 10;
let brushOpacity = 1;
let currentBrush = 'normal';
let currentBlendMode = 'source-over';
let zoomLevel = 1;
let offsetX = 0;
let offsetY = 0;
let isPanning = false;
let lastPanX = 0;
let lastPanY = 0;
let undoStack = [];
let redoStack = [];
let maxUndoSteps = 20;

// Initialize canvas
function initCanvas() {
  canvas.width = 800;
  canvas.height = 600;
  ctx.fillStyle = '#000000';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  saveState();
  
  // Set up event listeners
  setupEventListeners();
}

// Set up all event listeners
function setupEventListeners() {
  // Canvas drawing events
  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseout', stopDrawing);
  
  // Touch events for mobile
  canvas.addEventListener('touchstart', handleTouchStart);
  canvas.addEventListener('touchmove', handleTouchMove);
  canvas.addEventListener('touchend', handleTouchEnd);
  
  // Tool controls
  document.getElementById('color-picker').addEventListener('input', (e) => {
    currentColor = e.target.value;
    updateActivePresetColor();
  });
  
  document.getElementById('brush-size').addEventListener('input', (e) => {
    brushSize = parseInt(e.target.value);
    document.getElementById('brush-size-value').textContent = `${brushSize}px`;
  });
  
  document.getElementById('brush-opacity').addEventListener('input', (e) => {
    brushOpacity = parseInt(e.target.value) / 100;
    document.getElementById('opacity-value').textContent = `${e.target.value}%`;
  });
  
  // Brush type buttons
  document.querySelectorAll('.brush-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      document.querySelectorAll('.brush-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentBrush = btn.dataset.type;
    });
  });
  
  // Blend mode buttons
  document.querySelectorAll('.blend-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      document.querySelectorAll('.blend-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentBlendMode = btn.dataset.mode;
      ctx.globalCompositeOperation = currentBlendMode;
    });
  });
  
  // Preset colors
  document.querySelectorAll('.preset-color').forEach(color => {
    color.addEventListener('click', (e) => {
      document.querySelectorAll('.preset-color').forEach(c => c.classList.remove('active'));
      color.classList.add('active');
      currentColor = color.dataset.color;
      document.getElementById('color-picker').value = currentColor;
    });
  });
  
  // Control buttons
  document.getElementById('clear-btn').addEventListener('click', clearCanvas);
  document.getElementById('undo-btn').addEventListener('click', undo);
  document.getElementById('download-btn').addEventListener('click', showDownloadModal);
  document.getElementById('size-btn').addEventListener('click', showSizeModal);
  
  // Download modal
  document.getElementById('confirm-download').addEventListener('click', downloadCanvas);
  document.getElementById('cancel-download').addEventListener('click', () => {
    document.getElementById('download-modal').style.display = 'none';
  });
  
  // Size modal
  document.getElementById('size-confirm').addEventListener('click', applyCanvasSize);
  document.getElementById('size-cancel').addEventListener('click', () => {
    document.getElementById('size-modal').style.display = 'none';
  });
  
  // Zoom controls
  document.getElementById('zoom-in').addEventListener('click', () => zoom(0.1));
  document.getElementById('zoom-out').addEventListener('click', () => zoom(-0.1));
  document.getElementById('reset-view').addEventListener('click', resetView);
  
  // Canvas navigation
  document.getElementById('pan-up').addEventListener('click', () => panCanvas(0, 50));
  document.getElementById('pan-down').addEventListener('click', () => panCanvas(0, -50));
  document.getElementById('pan-left').addEventListener('click', () => panCanvas(50, 0));
  document.getElementById('pan-right').addEventListener('click', () => panCanvas(-50, 0));
  
  // Reference image controls
  document.getElementById('upload-ref-btn').addEventListener('click', () => {
    document.getElementById('reference-image-input').click();
  });
  
  const refInput = document.createElement('input');
  refInput.type = 'file';
  refInput.accept = 'image/*';
  refInput.id = 'reference-image-input';
  refInput.style.display = 'none';
  document.body.appendChild(refInput);
  
  refInput.addEventListener('change', handleReferenceImage);
  
  document.getElementById('ref-opacity').addEventListener('input', (e) => {
    const opacity = e.target.value;
    document.getElementById('ref-opacity-value').textContent = `${opacity}%`;
    document.getElementById('reference-image').style.opacity = opacity / 100;
  });
  
  document.getElementById('clear-ref-btn').addEventListener('click', clearReferenceImage);
  
  // Keyboard shortcuts
  document.addEventListener('keydown', handleKeyboardShortcuts);
}

// Drawing functions
function startDrawing(e) {
  isDrawing = true;
  [lastX, lastY] = getCoordinates(e);
  saveState();
}

function draw(e) {
  if (!isDrawing) return;
  
  e.preventDefault();
  
  const [x, y] = getCoordinates(e);
  
  ctx.beginPath();
  ctx.moveTo(lastX, lastY);
  ctx.lineTo(x, y);
  ctx.strokeStyle = currentColor;
  ctx.globalAlpha = brushOpacity;
  ctx.lineWidth = brushSize;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  ctx.stroke();
  
  [lastX, lastY] = [x, y];
}

function stopDrawing() {
  isDrawing = false;
}

function getCoordinates(e) {
  let clientX, clientY;
  
  if (e.type.includes('touch')) {
    clientX = e.touches[0].clientX;
    clientY = e.touches[0].clientY;
  } else {
    clientX = e.clientX;
    clientY = e.clientY;
  }
  
  const rect = canvas.getBoundingClientRect();
  const x = (clientX - rect.left - offsetX) / zoomLevel;
  const y = (clientY - rect.top - offsetY) / zoomLevel;
  
  return [x, y];
}

// Touch event handlers
function handleTouchStart(e) {
  e.preventDefault();
  const touch = e.touches[0];
  const mouseEvent = new MouseEvent('mousedown', {
    clientX: touch.clientX,
    clientY: touch.clientY
  });
  canvas.dispatchEvent(mouseEvent);
}

function handleTouchMove(e) {
  e.preventDefault();
  const touch = e.touches[0];
  const mouseEvent = new MouseEvent('mousemove', {
    clientX: touch.clientX,
    clientY: touch.clientY
  });
  canvas.dispatchEvent(mouseEvent);
}

function handleTouchEnd(e) {
  e.preventDefault();
  const mouseEvent = new MouseEvent('mouseup', {});
  canvas.dispatchEvent(mouseEvent);
}

// Canvas controls
function clearCanvas() {
  if (confirm('Are you sure you want to clear the canvas?')) {
    ctx.fillStyle = '#000000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    saveState();
  }
}

function saveState() {
  undoStack.push(canvas.toDataURL());
  if (undoStack.length > maxUndoSteps) {
    undoStack.shift();
  }
  redoStack = [];
}

function undo() {
  if (undoStack.length > 1) {
    redoStack.push(undoStack.pop());
    const img = new Image();
    img.onload = function() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);
    };
    img.src = undoStack[undoStack.length - 1];
  }
}

function redo() {
  if (redoStack.length > 0) {
    const img = new Image();
    img.onload = function() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);
    };
    img.src = redoStack.pop();
    undoStack.push(img.src);
  }
}

// Zoom and pan functions
function zoom(delta) {
  zoomLevel += delta;
  zoomLevel = Math.max(0.1, Math.min(5, zoomLevel));
  updateCanvasTransform();
  document.getElementById('zoom-display').textContent = `${Math.round(zoomLevel * 100)}%`;
}

function resetView() {
  zoomLevel = 1;
  offsetX = 0;
  offsetY = 0;
  updateCanvasTransform();
  document.getElementById('zoom-display').textContent = '100%';
}

function panCanvas(dx, dy) {
  offsetX += dx;
  offsetY += dy;
  updateCanvasTransform();
}

function updateCanvasTransform() {
  canvas.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${zoomLevel})`;
}

// Modal functions
function showDownloadModal() {
  document.getElementById('download-modal').style.display = 'flex';
}

function downloadCanvas() {
  const filename = document.getElementById('filename-input').value || 'inkflow-art';
  const link = document.createElement('a');
  link.download = `${filename}.png`;
  link.href = canvas.toDataURL('image/png');
  link.click();
  document.getElementById('download-modal').style.display = 'none';
}

function showSizeModal() {
  document.getElementById('canvas-width').value = canvas.width;
  document.getElementById('canvas-height').value = canvas.height;
  document.getElementById('size-modal').style.display = 'flex';
}

function applyCanvasSize() {
  const width = parseInt(document.getElementById('canvas-width').value);
  const height = parseInt(document.getElementById('canvas-height').value);
  
  if (width && height && width > 0 && height > 0) {
    // Save current canvas content
    const tempCanvas = document.createElement('canvas');
    const tempCtx = tempCanvas.getContext('2d');
    tempCanvas.width = canvas.width;
    tempCanvas.height = canvas.height;
    tempCtx.drawImage(canvas, 0, 0);
    
    // Resize canvas
    canvas.width = width;
    canvas.height = height;
    
    // Redraw content centered
    ctx.fillStyle = '#000000';
    ctx.fillRect(0, 0, width, height);
    ctx.drawImage(tempCanvas, (width - tempCanvas.width) / 2, (height - tempCanvas.height) / 2);
    
    saveState();
  }
  
  document.getElementById('size-modal').style.display = 'none';
}

// Reference image functions
function handleReferenceImage(e) {
  const file = e.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(event) {
    const img = new Image();
    img.onload = function() {
      document.getElementById('reference-image').src = event.target.result;
      document.getElementById('reference-image').style.display = 'block';
      document.querySelector('.reference-placeholder').style.display = 'none';
    };
    img.src = event.target.result;
  };
  reader.readAsDataURL(file);
}

function clearReferenceImage() {
  document.getElementById('reference-image').src = '';
  document.getElementById('reference-image').style.display = 'none';
  document.querySelector('.reference-placeholder').style.display = 'flex';
}

// Helper functions
function updateActivePresetColor() {
  document.querySelectorAll('.preset-color').forEach(color => {
    if (color.dataset.color === currentColor) {
      color.classList.add('active');
    } else {
      color.classList.remove('active');
    }
  });
}

function handleKeyboardShortcuts(e) {
  if (e.ctrlKey || e.metaKey) {
    switch(e.key) {
      case 'z':
        e.preventDefault();
        undo();
        break;
      case 'y':
        e.preventDefault();
        redo();
        break;
      case 's':
        e.preventDefault();
        showDownloadModal();
        break;
    }
  }
  
  if (e.key === 'Delete' && (e.ctrlKey || e.metaKey)) {
    e.preventDefault();
    clearCanvas();
  }
}

// Initialize the app when the page loads
window.addEventListener('load', initCanvas);
</script>
</body>
</html>
